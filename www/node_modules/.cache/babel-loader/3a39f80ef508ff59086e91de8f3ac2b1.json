{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport axios from 'axios';\nimport _get from 'lodash/get'; // axios#request(config)\n// axios#get(url[, config])\n// axios#delete(url[, config])\n// axios#head(url[, config])\n// axios#options(url[, config])\n// axios#post(url[, data[, config]])\n// axios#put(url[, data[, config]])\n// axios#patch(url[, data[, config]])\n// axios#getUri([config])\n\nvar API_URL = process.env.API_URL;\n\nvar api =\n/*#__PURE__*/\nfunction () {\n  function api() {\n    _classCallCheck(this, api);\n\n    this.api = axios.create({\n      baseURL: API_URL\n    });\n\n    this._resInterceptor = function (res) {\n      return _get(res, 'data', null);\n    };\n\n    this._errInterceptor = function (err) {\n      return _Promise.reject(err);\n    };\n\n    this.setInterceptors();\n    return this;\n  }\n\n  _createClass(api, [{\n    key: \"setInterceptors\",\n    value: function setInterceptors() {\n      this.api.interceptors.response.use(this.resInterceptor, this.errInterceptor);\n    }\n  }, {\n    key: \"onError\",\n    value: function onError() {\n      var errInterceptor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function (err) {\n        return _Promise.reject(err);\n      };\n      this.errInterceptor = errInterceptor;\n      return this; // make it chainable\n    }\n  }, {\n    key: \"onResponse\",\n    value: function onResponse() {\n      var resInterceptor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function (res) {\n        return _get(res, 'data', null);\n      };\n      this.resInterceptor = resInterceptor;\n      return this;\n    }\n  }, {\n    key: \"setBasicAuth\",\n    value: function setBasicAuth(_ref) {\n      var email = _ref.email,\n          password = _ref.password;\n      this.api = axios.create({\n        baseURL: API_URL,\n        auth: {\n          username: email,\n          password: password\n        }\n      });\n      this.setInterceptors();\n      return this;\n    }\n  }, {\n    key: \"setToken\",\n    value: function setToken(token) {\n      this.api.defaults.headers.common.Authorization = \"Bearer \".concat(token);\n      return this; // make it chainable\n    }\n  }, {\n    key: \"tokenValidate\",\n    value: function () {\n      var _tokenValidate = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var adminInfo;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.api.get('/auth');\n\n              case 2:\n                adminInfo = _context.sent;\n                return _context.abrupt(\"return\", adminInfo);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function tokenValidate() {\n        return _tokenValidate.apply(this, arguments);\n      }\n\n      return tokenValidate;\n    }()\n  }, {\n    key: \"loginAdmin\",\n    value: function () {\n      var _loginAdmin = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var adminInfo;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.api.post('/auth');\n\n              case 2:\n                adminInfo = _context2.sent;\n                console.log('Api.js login admin result -', adminInfo);\n                return _context2.abrupt(\"return\", adminInfo);\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function loginAdmin() {\n        return _loginAdmin.apply(this, arguments);\n      }\n\n      return loginAdmin;\n    }()\n    /**\n     * get index page markdown info\n     * @returns {String} markdown text\n     */\n\n  }, {\n    key: \"getIndex\",\n    value: function () {\n      var _getIndex = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.api.get('/info/index');\n\n              case 2:\n                res = _context3.sent;\n                return _context3.abrupt(\"return\", res);\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getIndex() {\n        return _getIndex.apply(this, arguments);\n      }\n\n      return getIndex;\n    }()\n  }, {\n    key: \"getStacks\",\n    value: function () {\n      var _getStacks = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.api.get('/info/stacks');\n\n              case 2:\n                res = _context4.sent;\n                return _context4.abrupt(\"return\", res);\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getStacks() {\n        return _getStacks.apply(this, arguments);\n      }\n\n      return getStacks;\n    }()\n  }, {\n    key: \"setIndex\",\n    value: function () {\n      var _setIndex = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(indexMarkdown) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return this.api.patch('/info/index', {\n                  indexMarkdown: indexMarkdown\n                });\n\n              case 2:\n                res = _context5.sent;\n                return _context5.abrupt(\"return\", res);\n\n              case 4:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function setIndex(_x) {\n        return _setIndex.apply(this, arguments);\n      }\n\n      return setIndex;\n    }()\n  }, {\n    key: \"setStacks\",\n    value: function () {\n      var _setStacks = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(stacks) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return this.api.patch('/info/stacks', {\n                  stacks: stacks\n                });\n\n              case 2:\n                res = _context6.sent;\n                return _context6.abrupt(\"return\", res);\n\n              case 4:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function setStacks(_x2) {\n        return _setStacks.apply(this, arguments);\n      }\n\n      return setStacks;\n    }()\n  }, {\n    key: \"createPost\",\n    value: function () {\n      var _createPost = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(post) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return this.api.post('/info/post', post);\n\n              case 2:\n                res = _context7.sent;\n                return _context7.abrupt(\"return\", res);\n\n              case 4:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function createPost(_x3) {\n        return _createPost.apply(this, arguments);\n      }\n\n      return createPost;\n    }()\n  }, {\n    key: \"resInterceptor\",\n    get: function get() {\n      return this._resInterceptor;\n    },\n    set: function set(newInterceptor) {\n      this._resInterceptor = newInterceptor;\n      this.setInterceptors();\n    }\n  }, {\n    key: \"errInterceptor\",\n    get: function get() {\n      return this._errInterceptor;\n    },\n    set: function set(newInterceptor) {\n      this._errInterceptor = newInterceptor;\n      this.setInterceptors();\n    }\n  }]);\n\n  return api;\n}();\n\nexport default api;","map":{"version":3,"sources":["/Users/gamecoach/codes/portfolio-2019q2/www/utils/Api.js"],"names":["axios","_get","API_URL","process","env","api","create","baseURL","_resInterceptor","res","_errInterceptor","err","reject","setInterceptors","interceptors","response","use","resInterceptor","errInterceptor","email","password","auth","username","token","defaults","headers","common","Authorization","get","adminInfo","post","console","log","indexMarkdown","patch","stacks","newInterceptor"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport _get from 'lodash/get';\n// axios#request(config)\n// axios#get(url[, config])\n// axios#delete(url[, config])\n// axios#head(url[, config])\n// axios#options(url[, config])\n// axios#post(url[, data[, config]])\n// axios#put(url[, data[, config]])\n// axios#patch(url[, data[, config]])\n// axios#getUri([config])\n\nconst { API_URL } = process.env;\n\nclass api {\n  constructor() {\n    this.api = axios.create({\n      baseURL: API_URL,\n    });\n    this._resInterceptor = res => _get(res, 'data', null);\n    this._errInterceptor = err => Promise.reject(err);\n    this.setInterceptors();\n    return this;\n  }\n\n  get resInterceptor() {\n    return this._resInterceptor;\n  }\n\n  get errInterceptor() {\n    return this._errInterceptor;\n  }\n\n  set resInterceptor(newInterceptor) {\n    this._resInterceptor = newInterceptor;\n    this.setInterceptors();\n  }\n\n  set errInterceptor(newInterceptor) {\n    this._errInterceptor = newInterceptor;\n    this.setInterceptors();\n  }\n\n  setInterceptors() {\n    this.api.interceptors.response.use(\n      this.resInterceptor,\n      this.errInterceptor,\n    );\n  }\n\n  onError(errInterceptor = err => Promise.reject(err)) {\n    this.errInterceptor = errInterceptor;\n    return this; // make it chainable\n  }\n\n  onResponse(resInterceptor = res => _get(res, 'data', null)) {\n    this.resInterceptor = resInterceptor;\n    return this;\n  }\n\n  setBasicAuth({ email, password }) {\n    this.api = axios.create({\n      baseURL: API_URL,\n      auth: {\n        username: email,\n        password,\n      },\n    });\n    this.setInterceptors();\n    return this;\n  }\n\n  setToken(token) {\n    this.api.defaults.headers.common.Authorization = `Bearer ${token}`;\n    return this; // make it chainable\n  }\n\n  async tokenValidate() {\n    const adminInfo = await this.api.get('/auth');\n    return adminInfo;\n  }\n\n  async loginAdmin() {\n    const adminInfo = await this.api.post('/auth');\n    console.log('Api.js login admin result -', adminInfo);\n    return adminInfo;\n  }\n\n  /**\n   * get index page markdown info\n   * @returns {String} markdown text\n   */\n  async getIndex() {\n    const res = await this.api.get('/info/index');\n    return res;\n  }\n\n  async getStacks() {\n    const res = await this.api.get('/info/stacks');\n    return res;\n  }\n\n  async setIndex(indexMarkdown) {\n    const res = await this.api.patch('/info/index', { indexMarkdown });\n    return res;\n  }\n\n  async setStacks(stacks) {\n    const res = await this.api.patch('/info/stacks', { stacks });\n    return res;\n  }\n\n  async createPost(post) {\n    const res = await this.api.post('/info/post', post);\n    return res;\n  }\n}\n\nexport default api;\n"]},"metadata":{},"sourceType":"module"}